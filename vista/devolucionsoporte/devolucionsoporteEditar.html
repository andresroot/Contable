{{define "body" }}
<link rel="stylesheet" href="{{ .hosting }}static/css/servicio.css"/>
<link rel="stylesheet" href="{{ .hosting }}static/css/jspanel.css"/>
<script type="text/javascript" src="{{ .hosting }}static/js/jspanel.js"></script>
<script src="{{ .hosting }}static/js/jquery-ui.js"></script>
<script src="{{ .hosting }}static/js/cleave.js"></script>
<div class="container-fluid">
<div class="col-md-12">
    <div class="card">
        <div class="card-body">
            <div class="row">
                <h3 class="tp">Editar Devolucion Soporte</h3>
            </div>
            <br>
                    <form id="formulario" method="POST"
                          action="DevolucionsoporteActualizar/">
                        <div class="form-group row mb-0">
                            <label class="col-sm-1 col-form-label">Resolucion</label>
                            <div class="col-sm-5">
                                <div class="md-form mt-0">
                                    <select name="Resolucionsoporte"
                                            id="Resolucionsoporte"
                                            class=" mdb-select md-form-control"
                                            editable="true">
                                        {{ range .resolucionsoporte }}
                                        <option value="{{ .Codigo }}">
                                            {{ .Numero}}-{{ .Prefijo }}-
                                            {{ .Tipo }}-{{.Local }}
                                        </option>
                                        {{ end }}
                                    </select>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row mb-0">
                            <label class="col-sm-1 col-form-label">Devolucion</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="text"
                                           name="Codigo"
                                           id="Codigo"
                                           class="form-control" required/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Proveedor</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="text"
                                           id="TerceroCodigo"
                                           class="form-control text-left"/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Nombre</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="text"
                                           id="TerceroNombre"
                                           class="form-control" disabled>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Direccion</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="text"
                                           id="TerceroDireccion"
                                           class="form-control" disabled>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row mb-0">
                            <label class="col-sm-1 col-form-label">Soporte No.</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="text"
                                           name="Soporte"
                                           id="Soporte"
                                           class="form-control" required/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Fecha</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="Date"
                                           placeholder="DD/mm/YYYY"
                                           name="Fecha"
                                           id="Fecha"
                                           class="form-control" required/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Fecha
                                Vence</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="Date"
                                           name="Vence"
                                           id="Vence"
                                           class="form-control" required/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Forma Pago</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="text"
                                           name="FormadepagoNombre"
                                           id="FormadepagoNombre"
                                           class="form-control" required/>
                                    <input type="hidden"
                                           name="Formadepago"
                                           id="Formadepago"
                                           class="form-control"/>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row mb-0">
                            <label class="col-sm-1 col-form-label">Medio Pago</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="text"
                                           name="MediodepagoNombre"
                                           id="MediodepagoNombre"
                                           class="form-control" required/>
                                    <input type="hidden"
                                           name="Mediodepago"
                                           id="Mediodepago"
                                           class="form-control"/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Almacenista</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="text"
                                           name="AlmacenistaNombre"
                                           id="AlmacenistaNombre"
                                           class="form-control" required/>
                                    <input type="hidden"
                                           name="Almacenista"
                                           id="Almacenista"
                                           class="form-control"/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Centro</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0">
                                    <input type="text"
                                           name="CentroNombre"
                                           id="CentroNombre"
                                           class="form-control" required/>
                                    <input type="hidden"
                                           name="Centro"
                                           id="Centro"
                                           class="form-control"/>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row mb-0">
                            <table id="tabla"
                                   class="table table-sm" cellspacing="0" width="100%">
                                <thead class="miCabeceraTabla">
                                <tr>
                                    <th></th>
                                    <th></th>
                                    <th>No</th>
                                    <th style="padding-left: 6px">Codigo</th>
                                    <th style="padding-left: 5px">Nombre Producto</th>
                                    <th style="padding-left: 5px">Unidad</th>
                                    <th style="padding-left: 15px">Iva</th>
                                    <th style="padding-left: 6px">Bodega</th>
                                    <th style="padding-left: 65px">Cantidad</th>
                                    <th style="padding-left: 50px">Vr. Unitario</th>
                                    <th style="padding-left: 100px">Total</th>
                                    <th></th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                        <input type="hidden" id="Subtotal19"/>
                        <input type="hidden" id="Subtotal5"/>
                        <input type="hidden" id="Subtotal0"/>
                        <input type="hidden" id="SubtotalDescuento19"/>
                        <input type="hidden" id="SubtotalDescuento5"/>
                        <input type="hidden" id="SubtotalDescuento0"/>
                        <div class="form-group row mb-0">
                            <label class="col-sm-1 col-form-label">Base
                                19%</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0 mdo">
                                    <input type="text"
                                           id="SubtotalBase19"
                                           class="form-control text-right"/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Base
                                5%</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0 mdo">
                                    <input type="text"
                                           id="SubtotalBase5"
                                           class="form-control text-right"/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Base 0%</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0 mdo">
                                    <input type="text"
                                           id="SubtotalBase0"
                                           class="form-control text-right"/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label tl">Subtotal</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0 ml-4 mdt">
                                    <input type="text"
                                           id="Subtotal"
                                           class="form-control text-right"/>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row mb-0">
                            <label class="col-sm-1 col-form-label">Total Items</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0 mdo">
                                    <input type="text"
                                           id="Items"
                                           class="form-control text-right"
                                           readonly/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Porcentaje</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0 mdo">
                                    <input type="text"
                                           id="PorcentajeRetencionIca"
                                           class="form-control text-right"/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label">Porcentaje</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0 mdo">
                                    <input type="text"
                                           id="PorcentajeRetencionFuente"
                                           class="form-control text-right"/>
                                </div>
                            </div>
                            <label class="col-sm-1 col-form-label tl">Ret. Fte.</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0 ml-4 mdt">
                                    <input type="text"
                                           id="TotalRetencionFuente"
                                           class="form-control text-right"/>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row mb-0">
                            <div class="col-sm-9"></div>
                            <label class="col-sm-1 col-form-label tl">Ret. Ica</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0 ml-4 mdt">
                                    <input type="text"
                                           id="TotalRetencionIca"
                                           class="form-control text-right"/>
                                </div>
                            </div>
                        </div>
                        <div class="form-group row mb-0">
                            <div class="col-sm-9"></div>
                            <label class="col-sm-1 col-form-label tl">Total
                                Neto</label>
                            <div class="col-sm-2">
                                <div class="md-form mt-0 ml-4 mdt">
                                    <input type="text"
                                           id="Neto"
                                           class="form-control text-right"/>
                                </div>
                            </div>
                        </div>
                        <br>
                        <div class="form-group row mb-0">
                            <div class="col-sm-12">
                                <a href="/DevolucionsoporteLista"
                                   class="btn btn-outline-dark waves-effect btn-md float-right mdbi">Cancelar </a>
                                <button type="button" id="guardar"
                                        onclick="guardardoc('Actualizar')"
                                        class="btn btn-outline-success waves-effect btn-md float-right mdbi">
                                    Guardar
                                </button>
                            </div>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>
<!--   INICIA NUEVO TERCERO-->
<input id="TerceroNuevo"
       type="hidden"/>
<input id="FormadepagoNuevo"
       type="hidden"/>
<input id="MediodepagoNuevo"
       type="hidden"/>
<input id="AlmacenistaNuevo"
       type="hidden"/>
<input id="CentroNuevo"
       type="hidden"/>
<input id="ProductoNuevo"
       type="hidden"/>
<input id="BodegaNuevo"
       type="hidden"/>
<input id="Total"
       type="hidden"/>
<input id="retfte" value="{{ .retfte }}"
       type="hidden"/>

<script src="{{ .hosting }}static/js/Soporte.js"></script>

        {{template "devolucionsoportescript" }}
        {{template "autocompletaFormadepago" }}
        {{template "autocompletaMediodepago" }}
        {{template "autocompletaAlmacenista" }}
        {{template "autocompletaCentro" }}
        {{template "autocompletaBodega" }}
        {{template "autocompletaTercero" }}
<script>
$(document).ready(function () {
    // INICIA FECHA
    var m = moment().format("YYYY-MM-DD");
    $("#Fecha").val(m);
    $("#Vence").val(m);

    // INICIA CREAR DUPLICADO CON F2
    $(document).on('keyup', '#Fecha', function (e) {
        var code = e.keyCode || e.which;
        if (e.which == 113) {
            document.location.href = '/DevolucionsoporteNuevo/' + $("#Codigo").val();
        }
    });

    // INICIA AUTOCOMPLETADO
    autocompletaTercero('#TerceroCodigo');

    autocompletaFormadepago('#FormadepagoNombre', '#Formadepago');
    autocompletaMediodepago('#MediodepagoNombre', '#Mediodepago');
    autocompletaAlmacenista('#AlmacenistaNombre', '#Almacenista');
    autocompletaCentro('#CentroNombre','#Centro');

    // INICIA FOCUS
    $('#Fecha').focus();

     $('#Resolucionsoporte').materialSelect({});

    // llenar valores
    $("#Resolucionsoporte").val('{{ .soporte.Resolucionsoporte }}');
    $("#Codigo").val('{{ .devolucionsoporte.Codigo }}');
    $("#Fecha").val('{{ .devolucionsoporte.Fecha.Format "2006-01-02"}}');
    $("#Vence").val('{{ .devolucionsoporte.Vence.Format "2006-01-02"}}');
    $("#Plazo").val('');

    $("#TerceroCodigo").val('{{ .devolucionsoporte.Tercero }}');
    $("#TerceroDv").val('{{ .devolucionsoporte.TerceroDetalle.Dv }}');
    $("#TerceroNombre").val('{{ .devolucionsoporte.TerceroDetalle.Nombre }}');
    $("#TerceroDireccion").val('{{ .devolucionsoporte.TerceroDetalle.Direccion }}');
    $("#TerceroTelefono1").val('{{ .devolucionsoporte.TerceroDetalle.Telefono1 }}');
    $("#TerceroEmail1").val('{{ .devolucionsoporte.TerceroDetalle.Email1 }}');

    $('#Subtotal').val('{{ .devolucionsoporte.Subtotal }}');
    $('#SubtotalBase19').val('{{ .devolucionsoporte.Subtotalbase19 }}');
    $('#SubtotalBase5').val('{{ .devolucionsoporte.Subtotalbase5 }}');
    $('#SubtotalBase0').val('{{ .devolucionsoporte.Subtotalbase0 }}');
    $('#Total').val('{{.devolucionsoporte.Total }}');
    $('#PorcentajeRetencionFuente').val('{{ .devolucionsoporte.PorcentajeRetencionFuente }}');
    $('#TotalRetencionFuente').val('{{ .devolucionsoporte.TotalRetencionFuente }}');
    $('#PorcentajeRetencionIca').val('{{ .devolucionsoporte.PorcentajeRetencionIca }}');
    $('#TotalRetencionIca').val('{{ .devolucionsoporte.TotalRetencionIca }}');
    $('#Neto').val('{{ .devolucionsoporte.Neto }}');
    $('#Formadepago').val('{{ .devolucionsoporte.Formadepago}}');
    $('#Mediodepago').val('{{ .devolucionsoporte.Mediodepago}}');
    $('#Almacenista').val('{{ .devolucionsoporte.Almacenista}}');
    $('#Soporte').val('{{ .devolucionsoporte.Soporte}}');
    $('#Centro').val('{{ .devolucionsoporte.Centro}}');
    $("#PorcentajeRetencionFuente").val($("#retfte").val());

    $('#CentroNombre').val('{{ .devolucionsoporte.CentroDetalle.Nombre}}');
    $('#FormadepagoNombre').val('{{ .devolucionsoporte.FormadepagoDetalle.Nombre}}');
    $('#MediodepagoNombre').val('{{ .devolucionsoporte.MediodepagoDetalle.Nombre}}');
    $('#AlmacenistaNombre').val('{{ .devolucionsoporte.AlmacenistaDetalle.Nombre}}');
    // llenar detalle
    cont = 1;

    {{ range.detalle }}
    agregar();
    $('#seleccion_producto' + cont).val('{{ .Producto }}');
    $('#nombre' + cont).html('{{ .ProductoNombre }}');
    $('#unidad' + cont).html('{{ .ProductoUnidad }}');
    $('#iva' + cont).html('{{ .ProductoIva }}');
    $('#seleccion_bodega' + cont).val('{{ .Bodega }}');
    $('#seleccion_bodega_nombre' + cont).val('{{ .BodegaNombre }}');
    $('#cantidad' + cont).val(formatomoneda('{{ .Cantidad }}'));
    $('#valor' + cont).val(formatomoneda('{{ .Precio }}'));
    cont++;

    {{ end }}
        totales();
});

</script>
{{end}}
